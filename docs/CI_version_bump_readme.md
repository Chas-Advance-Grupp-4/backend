## Version Bump Workflow ##
This document describes the GitHub Actions workflow for automatically bumping the version of the repository. It detects changes in the **VERSION** file, increments it if needed, and creates a pull request with the new version.

### Purpose ###
- Automatically check if the **VERSION** file needs to be bumped on pushes to **develop** or **main**.

- Prevent duplicate version bumps by checking if the last commit already updated **VERSION**.

- Generate a GitHub App token to perform version bump commits and create pull requests securely.

- Ensure consistent versioning in the repository and reduce manual errors.

### Workflow Triggers ###
- **Automatic**: On push to **develop** or **main**.  

- **Manual**: Trigger via **workflow_dispatch** in GitHub Actions.

### Steps ###
**1. Checkout repository** - Fetches the full repository history (`fetch-depth: 0`) to allow comparison with previous commits.

**2. Check if VERSION file changed**
- Runs `git diff HEAD~1 --name-only` to see if **VERSION** was modified in the last commit.
- Sets environment variable `bump_needed` to `true` if file wasn't updated in last commit and to `false` if it was updated.
- If `bump_needed` is `false`, the workflow exits early.

**3. Generate GitHub App token**
- Only runs if a version bump is needed.
- Uses `actions/create-github-app-token@v1.1.0` to generate a temporary token with permissions to write content and pull requests.

**4. Make script executable** - Runs `chmod +x .github/scripts/bump_version.sh` to ensure the version bump script can be executed.

**5. Bump version** - Executes `.github/scripts/bump_version.sh` to increment the version according to your versioning rules.

**6. Log new version** - Prints the new version to the workflow logs for visibility.

**7. Commit and create PR**
- Configures git user as `github-actions[bot]`.
- Creates a new branch `version-bump-<branch>-<run_number>`.
- Commits the updated **VERSION** file.
- Pushes the branch to the remote repository.
- Creates a pull request with the title `Bump version to <VERSION>` and body describing the update.

### Environment Variables & Secrets ###
- **APP_ID** & **PRIVATE_KEY**: Used to authenticate the GitHub App for creating commits and PRs.

- **GITHUB_TOKEN**: Generated by the workflow to authorize git push and pull request creation.

### Best Practices ###
- Ensure **VERSION** file is properly formatted and maintained.

- Always review the PR created by the workflow before merging.

- Keep secrets safe in GitHub Actions settings; do not expose them in code.

### Notes ###
- Workflow only runs on non-forked repositories (`if: github.event.repository.fork == false`).

- The new version is determined automatically by `.github/scripts/bump_version.sh`.

- Pull requests created by the workflow ensure consistent versioning without manual intervention.

- Merge the PR to update the **VERSION** file and trigger downstream workflows that depend on it.